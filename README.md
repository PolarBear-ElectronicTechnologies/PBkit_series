# PBkit 401 (A and A-BASE) Hardware Development Guide

[images/10001.png]

---

## 1. Питание 
- Основное питание: **5 В, ≥ 1,35 А**. При питании через USB-OTG возможны пиковые токи > 500 мА, что может приводить к перезапуску платы.  
- **Контроль EN** PMIC: пин EN переключает систему на 3,3 В. Нельзя подавать питание материнской платы раньше основной, чтобы избежать подачи напряжения на ЦП через IO и его повреждения.  
- **Ширина дорожки питания** рассчитывается по току: 1 oz-медь × 28 mil обеспечивает 1 А; DCR = длина/(ширина·толщина), переход отверстия 8 mil пропускает до 500 мА.
  
MINI version for embedded systems ( эта плата используется для встраиваемых систем, отдельно не функционирует)

!()[images/10003.png]
!()[images/10002.png]

---

## 2. Аудио 
- **AGND**: медная шина ≥ 80 mil, соединена с GND ≥ 2 переходами.  
- **HPOUTL/R, HPCOM, HPCOMFB**: симметричное расположение трасс (10 mil), группировка вокруг заземления, удалённость от высокоскоростных линий.  
- **Микрофон**: ≥ 200 mil от RF/PA, ESD-защита рядом с входом, MICxP/N – дифференциальная пара 4 mil/4 mil с контурным заземлением.  
- **LINEIN, PHONEOUT**: дифференциальные пары, окружённые GND, ширина 4 mil, расстояние ≥ 2× ширины.

---

## 3. CSI (камера) 
- **Ширина трасс** PCLK/Data – 15–20 mil, минимальное число переходов (≤ 2).  
- **Расположение модуля** рядом с большой GND-площадью для теплоотвода; FPC короткие, минимум изгибов.  
- **Согласование** ёмкостей и последовательных сопротивлений на PCLK, MCLK, Hsync – близко к значениям основного контроллера.  
- **Разделение AVDD-CSI и IOVDD-CSI** при разных временных диаграммах питания; автофокус – отдельный шумоподавленный источник.

---

## 4. Ethernet 
- **PHY** рядом с разъёмом RJ45 и сплошным опорным слоем.  
- **Кварц и конденсаторы** расположены максимально близко к PHY, экранирование GND-слоями.  
- **Дифференциальные пары** 100 Ω ± 10%, одинаковая длина ± 200 mil, внутренний допуск ± 20 mil.

---

## 5. HDMI 
- **ESD** TVS-диод у разъёма, минимальная длина сигнальной пары до контроллера.  
- **Дифференциальные пары** 100 Ω ± 10%, ширина 4,5–5,5 mil, шаг 8–9 mil, расстояние между парами ≥ 3× ширины.  
- **Длина трассы** < 3000 mil, отклонение пары < 200 mil, между парами < 1000 mil; избегать 90° поворотов (использовать 45°).

---

## 6. RGB / LVDS / DSI 
- **Расстояние** между линиями ≥ 3× ширины (минимум 2×).  
- **CLK** экранировать GND-слоем, фильтрующий конденсатор VCC рядом с контроллером.  
- **LVDS**: 100 Ω дифференциальный, допуск длины пары ≤ 10 mil (1080p) / ≤ 20 mil (720p), между парами ≤ 180 mil / ≤ 450 mil.  
- **DSI**: аналогичные требования, +100 nF конденсатор у каждого VCC-контакта.

---

## 7. SATA 
- **Дифф. пары** TX/RX – 100 Ω, угол ≥ 135°, длина < 4000 mil, ≤ 2 переходов.  
- **Конденсаторы** у разъёма, трассы на внешнем слое, сплошной опорный слой под ними.  
- **Разметка** – приоритет расстояния до других линий ≥ 10 mil.

---

## 8. SDIO 
- **ESD-защита** у слота или модуля Wi-Fi, резистивно-конденсаторные сети у VDD рядом с интерфейсом.  
- **Импеданс** сигнальных линий 50 Ω, между дорожками ≥ 2× ширины, равная длина D0–D3 относительно CLK < 500 mil.  
- **VDD-шина** ≥ 12 mil, переходы GND у CLK.

---

## 9. TVIN 
- **Разделительный конденсатор** ≤ 200 mil от питания, GND-TVIN – отдельная шина ≥ 50 mil, соединение через 0 Ω к основному GND.  
- **Импеданс** сигнальной линии 37,5 Ω, избегать пересечения с высокоскоростными трассами.

---

## 10. TVOUT / CVBS / VGA 
- **75 Ω** терминаторы и ESD у разъёма.  
- **CVBS** – однонаправленная линия, **VGA** – три линии, каждая 75 Ω.  
- Трассы должны прилегать к GND-слою, без пересечений.

---

## 11. USB
- **TVS-диоды** у VBUS, ESD у разъёма.  
- **DP/DM** – 90 Ω дифф-пара, угол ≥ 135°, длина < 4000 mil, ≤ 2 переходов.  
- **Ёмкость TVS** ≤ 4 pF, дистанция до других трасс ≥ 10 mil.

---

## 12. Wi-Fi / BT 
- **Антенный фидер** 50 Ω, минимальное число изгибов, без переходов.  
- **Расположение модуля** вдали от шумных источников (LCD, моторы, динамики).  
- **Заземление** фидера – дополнительные переходы GND слева и справа.

---

## 13. ESD 
- **Сплошной GND-слой**, кольцевое заземление платы ≥ 20 mil, разрыв ≤ 1 mm, ≥ 2 перехода/10 mm.  
- **Расстояния**: сигналы IO от края защитного кольца ≥ 10 mil, ключевые линии (RESET/Clock) ≥ 5 mm от края платы.  
- **Защита внешних интерфейсов**: ESD-устройства у каждого разъёма, минимальная длина сигнальной дорожки к TVS, ≥ 3 перехода к GND.

---
## Практика на pbkit 401 

Проведем небольшой опыт по настройке и работе с платой на классическом примере работы со светодиодом, если на Вашей системе установлена библиотека libgpiod, можно воспользоваться Python для  управления GPIO (или использовать общение через bash):
# Настройка и запуск мигания LED с Python и libgpiod

Ниже приведены шаги по установке зависимостей, созданию скрипта и его запуску.

!(turn on)[images/1.jpg]
---

## 1. Установка зависимости

```bash
sudo apt update
sudo apt install -y python3-libgpiod

#!/usr/bin/env python3
import time
from gpiod import Chip, LineRequest

# Задайте свой GPIO-номер
GPIO_PIN = 18
CHIP = "/dev/gpiochip0"  # Проверьте, какой gpiochip соответствует вашему контроллеру

# Инициализация
chip = Chip(CHIP)
line = chip.get_line(GPIO_PIN)
line.request(consumer="blink", type=LineRequest.DIRECTION_OUTPUT, default_vals=[0])

try:
    while True:
        line.set_value(1)  # Включить LED
        time.sleep(0.5)
        line.set_value(0)  # Выключить LED
        time.sleep(0.5)
except KeyboardInterrupt:
    pass
finally:
    line.set_value(0)
    line.release()
```
## 2. Слхранение и установка
```bash
chmod +x blink.py # сохраняем код в файл
sudo ./blink.py # запускаем файл в исполнение

```
!(led)[images/2.jpg]
---

> **Примечание:** Все рекомендации относятся к разводке PCB и выбору компонентов для обеспечения надёжности, EMC-совместимости и простоты отладки. Следуйте этим правилам, чтобы минимизировать проблемы при производстве и эксплуатации платы A40I.
> > Все технические файлы Вы можете найти на нашем сайте: https://pb-embedded.ru/?ysclid=mb0xwcpmmj97014171
> Также мы есть в Telegram: [Скорее напишите нам](https://t.me/PBPOLAR)

